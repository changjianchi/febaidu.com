# 谢耀武

> 2016年8月22日~2016年8月26日

## 本周进度

* 调查wise上线进度和优化
* 开发js拼mip、sf2的方法，预计08-26ci代码并给出相关文档
* 配合www整个使用moplus的组件并替换相关有问题的文件
* 整理平台的文档
* 升级平台代码的配置，减少svn diff的文件，不过还有坑，周末梳理

## 基础模板

### 目标

* 满足业务需求
* 更高的易用性 - api、通用机制
* 文档更健全

### 任务list

* wise中js拼sf、mip链接 - 已完成，预计08-26(周五)上线
* showlamp短线实现 - 预计08-30(下周二)上线，上线后会推动整个foot的升级
* 调研c_base中`title block`的需求，并优化，需要考虑到重写方便、可调框、官网图标
* 跟@qijian、@yuanwei再对下模板编译时fis合并amd文件

### 问题

* 需求分散化 - 由方向owner负责方向相关的事
* 优化文档

## 平台方向

> 按优先级排序

### 功能性优化

1. 预览时接入qa沙盒自动化 - ing
1. 调研哥伦布是否需要平台线下预览
1. 调研sf2是否需要平台线下预览
1. 上线通知列表支持新增类型及预览页
1. 同步测试机环境优化

### 规范检查优化 - ing

1. pad.tpl内容检查/ 新增模板自动创建
1. include、inline、extends跨模板检查
1. 数据转码检查
1. 数据结构检查
1. 新增模板黑名单检查（不能以指定的名单为文件名）

### 跟pm.open对接

已跟@liuchen沟通，下周当面沟通下该方面的对接，比如删除模板时的接口等

### 建立平台文档 - ing

1. 现有代码、目录说明
1. 相关服务器说明
1. svn路径说明
1. 新规范说明
1. 后端接口新路径说明
1. 前端新架构说明

## aladdin-wise 上线优化

### 背景

针对目前的上线进度，分析整个上线时间点，给出可优化的时间点

#### 全量 - 2个人上线

* 平台创建->沙盒编译: 21分钟
* 沙盒确认: 2分钟
* 平台ci+agile操作: 6分钟
* 静态文件全量: 13分钟
* 模板单台: 5分钟
* 模板单台确认: 7分钟
* 模板全量: 1小时30分
* 整体上线: 2小时40分钟

### 普通编译 - 19个人

* 平台创建->沙盒编译: 17分钟
* 沙盒确认: 30分钟
* 平台ci+agile操作: 7分钟
* 静态文件全量: 14分钟
* 模板单台: 5分钟
* 模板单台确认: 29分钟
* 模板全量: 1小时29分
* 整体上线: 3小时02分钟

## card - 1个人

* 平台创建->沙盒编译: 2分钟
* 沙盒确认: 5分钟
* 平台ci+agile操作: 7分钟
* 静态文件全量: 14分钟
* 模板单台: 1分钟
* 模板单台确认: 23分钟
* 模板全量: 24分
* 整体上线: 1小时25分钟

> 以上时间点是比较顺利的，如果有沙盒重新编译要再加时间

### 结论

对比全量上线、多人上线、card上线，总结如下：

* wise的全量时间为1小时30分钟，可以优化分组并发数来提升时间
* 发现在上线确认时很是耗时，特比有是人多的时候，可以明确整个时间点，到点就编译，第一时间在找里@相关人，短时间不确认则打电话咨询

### 优化

1. 推动删除pad.tpl文件，会有减少837个文件编译，并且还会减少tar包体积
1. 每天10:30、15:30准时沙盒编译，如果时间点内没有达到上线状态，则不带其上线
1. 沙盒编译后群里@相关的人员确认，等一休的@api完善后可自动@相关的人，沙盒5分钟后直接单台上线
1. 单台完成后群里@相关的人员确认，1分钟未回复的直接打电话，保证在10分钟之内确认效果

---

20个人

* 平台创建->沙盒编译: 17分钟
* 沙盒确认: 5分钟
* 平台ci+agile操作: 7分钟
* 静态文件全量: 14分钟
* 模板单台: 5分钟
* 模板单台确认: 10分钟
* 模板全量: 30-60分钟
* 整体上线: 1小时30分钟-2小时