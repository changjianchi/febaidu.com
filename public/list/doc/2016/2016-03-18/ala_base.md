# 【阿拉丁基础建设方向周报】

> 从2016-03-14到2016-03-18

## 哥伦布基础架构

### 背景

哥仑布项目，目前已有的机制很难做到支持。需要升级

### 进度

1、大部分代码已上线（aladdin模板、基础库、统计、fis），依赖sigma机制和平台的部分代码还没上    
2、哥伦布功能方面：子卡的弱展现，以及展开收起需要单独开发 - 整体上线前开发完
3、整体结合sigma机制跟rd联调 - 联调完成，周五odp提测    
4、下周需要跟进上线和第一批模板的开发


## sigma 机制

### 背景

1、 目前的 sigma 机制比较卡顿    
2、 必须要求模板有iphone和iphone.only两套模板，不够灵活。线在线上很多query在白卡时是9条结果。    
3、 之前哥伦布的方案没有涉及到 sigma 相关，以现有的机制上来实现哥伦布会比较麻烦。    

### 进度

1、16号开始和odp、us联调，目前已经进入测试阶段，www模块代码能向下兼容，故18号操作上线@浪波    
2、通用逻辑移至结果页(头图、隐藏结果等逻辑。品专接入sigma有依赖） - 上线前开发完
3、下周上线，并跟进相关效果    
4、由于新机制的代码使用了以前的代码，需要将代码按照目前规范修改（优先保下周上线，上线前未改完则把现有代码逻辑上线）   


## wise模板开发平台化二期
#### 项目背景
wise阿拉丁模板开发未平台化，部署环境、调试代码成本比较高，而且目前参与wise阿拉丁模板开发的产品线有十几个，急需一个平台来管理开发人员及相关模板，以提高后续模板开发及人员管理成本。

#### 目标
* 开发统一：所有产品线及所有端模板，开发统一，规范统一，流程统一
* 上线统一：统一所有搜索结果模板权限控制和上线控制
* 管理统一：所有产品线及所有端模板，统一平台管理、监控、验证等

#### 整体计划
* 发单之前部署沙盒预览环境  1.20-1.25
* wise添加例行日志信息  1.25-2.1
* 支持哥伦布开发升级    2.2-3.15
    * 模板开发模块支持多根目录升级  2.22-3.1
    * 任务模块升级  3.2-3.3
    * pc&wise smarty编译脚本升级 3.4
    * 新增模板升级  3.7-3.8
        * 增加主模板类型 
    * 预览升级
        * 支持多模板编译    3.8
        * 子卡预览选项增加“选择子卡”和“选择主模板”  3.9-3.11
        * 预览数据在线merge 3.11-3.14
* 静态文件增加数据库管理    3.16-3.30
* 上线流程自动化管理 4月份

#### 本周工作

* 哥伦布子卡预览开发完成
* 平台送测，修复相应的bug


## xml转mcpack
#### 项目背景
xml数据大小比mcpack大，需要和pc端打平

#### 问题
* 单个result转mcpack是数组形式，xml是object形式，7个模板需兼容，预计3.15之前上线
* mini属性字段现状是_xxx，转mcpack后变成@xxx，7个模板需兼容，预计3.15之前上线
* num_baidu字段diff存在17个模板需兼容处理，预计3.15之前上线
* kv资源转mcpack的属性字段会跟pc一样，变成二维数组，涉及模板约200多个，需分批迁移

#### 进度

* 除了stockdynamic_moretab和bk_polysemy问题未修复，其他的都已上线，问题模板预计下周一上线



## wise sigma体验优化项目

### 背景与目标

sigma展现明显有白屏，然后再出现模板;低端机器ipod、iphone5等，页面比较复杂是上下滑动卡顿

### 完成情况

* 1、分析页面卡顿原因，通过排查，发现去掉iscroll功能体验会好很多，并且手百上下滑动一次会触发resize30多次

* 2、解决方案未定，初步推手百优化，产品层面看看能否少用iscroll功能。

### 本周进展

* 1、原生scroll方案已确定，组件已开发完毕，模板批量修改完成，3月18号进入测试阶段，预计21号上线小流量

* 2、测试环境地址： http://cp01-ps-fe-3.epc.baidu.com:8003/s?word=%E4%B8%8A%E6%B5%B7


## 整体结果页loading效果(@浪波)

### 背景

sigma会在结果返回后去修改头部搜索框皮肤，会造成头部明显的跳动，正常结果也会出现下面空白情况，为了优化体验，增加重新搜索的loading效果

### 完成情况

3月14号上线小流量实验

实验地址：http://m.baidu.com/s?word=%E4%B9%8C%E9%95%87&sid=104007

实验组：104007 流量3%

对照组：104008 流量3%

### 后续todo

同步跟进实验数据

预取和异步交互体验一致性

## 阿拉丁协同项目

### 背景

缩减阿拉丁样式，使结果页10条样式保持风格一致

### 进展

增加5种弱样式

弱化流程已经敲定，暂时由我这边和pm接口，完成平稳退化，后续放开权限给pm同学

站长平台RD支持schema批量增加，本周完成联调，预计功能下周二上线

模板平台RD支持批量增加fn配置，17号已经上线生效


## tc跳转相关

### 背景

目前模板中tc链接的生成比较混乱，许多项目有依赖，需要统一

### 进度

本周给出未使用tc插件的模板列表    
沟通升级方案 - 周五


## 上线时间持续跟进优化

### 背景与目标

目前wise上线时间比较久，比PC慢了一倍多。需要持续跟进和优化上线时间，以减少上线人力成本和快速响应紧急需求。

### 进度

1、OP去掉了机房互斥锁 - 后面继续跟进    
2、推进OP去掉上线sleep 60s - op下周评估aladdin上线的影响，给出结论    
